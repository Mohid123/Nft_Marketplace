"use strict";(self.webpackChunknft_panel=self.webpackChunknft_panel||[]).push([[776],{6658:(P,x,i)=>{i.d(x,{y:()=>b});var Z=i(8583),a=i(4294),M=i(9922),_=i(2352),F=i(7716),I=i(1841),T=i(9344);let b=(()=>{class v extends _.s{constructor(g,p,n){super(p),this.document=g,this.http=p,this.toastrService=n,this.maxWidth=538,this.maxHeight=529}uploadMedia(g,p){return this.postMedia(`/media-upload/mediaFiles/${g}`,p).pipe((0,a.q)(1),(0,M.b)(n=>{var e,m;n.hasErrors()&&this.toastrService.error(null===(m=null===(e=null==n?void 0:n.errors[0])||void 0===e?void 0:e.error)||void 0===m?void 0:m.message)}))}convertToImg(g,p){return new Promise(n=>{const e=document.createElement("canvas"),m=e.getContext("2d"),l=new Image;l.src=g,l.onload=()=>{e.width=72,e.height=64,m.drawImage(l,0,0,l.width,l.height,0,0,72,64),n(this.dataURLtoFile(e.toDataURL(),p))}})}dataURLtoFile(g,p){const n=g.split(","),e=n[0].match(/:(.*?);/)[1],m=atob(n[1]);let l=m.length;const h=new Uint8Array(l);for(;l--;)h[l]=m.charCodeAt(l);return new File([h],p,{type:e})}compressImage(g){return new Promise((p,n)=>{const e=document.createElement("canvas"),m=e.getContext("2d"),l=new Image;l.src=URL.createObjectURL(g),l.onload=()=>{const h=this.calculateAspectRatioFit(null==l?void 0:l.width,null==l?void 0:l.height);e.width=h.width,e.height=h.height,m.drawImage(l,0,0,l.width,l.height,0,0,h.width,h.height),p(this.dataURLtoFile(e.toDataURL(),"thumbnail.jpg"))}})}calculateAspectRatioFit(g,p){const n=Math.min(this.maxWidth/g,this.maxHeight/p);return{width:g*n,height:p*n}}generateThumbnail(g,p){const n=this.document.createElement("video"),e=this.document.createElement("canvas"),m=document.createElement("canvas"),l=e.getContext("2d"),h=m.getContext("2d");return new Promise((U,w)=>{e.addEventListener("error",w),n.addEventListener("error",w),n.addEventListener("loadedmetadata",()=>{n.currentTime=Math.round(n.duration/2),l.drawImage(n,0,0,n.videoWidth,n.videoHeight)}),n.addEventListener("canplay",A=>{e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0,n.videoWidth,n.videoHeight);var d=new Image;d.src=e.toDataURL(),d.onload=()=>{let y=this.calculateAspectRatioFit(null==d?void 0:d.width,null==d?void 0:d.height);m.width=y.width,m.height=y.height,h.drawImage(d,0,0,d.width,d.height,0,0,y.width,y.height),U(this.dataURLtoFile(m.toDataURL(),p+".jpg"))}}),g.type&&n.setAttribute("type",g.type),n.preload="auto",n.src=window.URL.createObjectURL(g),n.load()})}}return v.\u0275fac=function(g){return new(g||v)(F.LFG(Z.K0),F.LFG(I.eN),F.LFG(T._W))},v.\u0275prov=F.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},5776:(P,x,i)=>{i.r(x),i.d(x,{CreateGroupDialogModule:()=>k});var Z=i(8583),a=i(3679),M=i(6237),_=i(9344),F=i(4819),I=i(3291),T=i(6889),b=i(1598),v=i(1964),O=i(2687),g=i(5755),p=i(4294),n=i(7580),e=i(7716),m=i(7423),l=i(6989),h=i(1659),U=i(6658),w=i(1841),A=i(9866),d=i(9309),y=i(4228);const G=["imgFile"];function L(r,c){1&r&&(e.TgZ(0,"p",31),e._uU(1,"please enter name"),e.qZA())}function E(r,c){if(1&r&&(e.TgZ(0,"p",31),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("name should be greater than or equal to ",null==t.groupForm.controls.name.errors?null:t.groupForm.controls.name.errors.minlength.requiredLength," character ")}}function D(r,c){if(1&r&&(e.TgZ(0,"li",32),e.TgZ(1,"ul",33),e._UZ(2,"img",34),e.qZA(),e.qZA()),2&r){const t=e.oxw();e.xp6(2),e.s9C("src",t.imageSrc,e.LSH)}}function S(r,c){1&r&&(e.ynx(0),e.TgZ(1,"div",35),e._uU(2,"Select Image to Upload"),e.qZA(),e.BQk())}function N(r,c){if(1&r&&(e.TgZ(0,"div",36),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.groupFile.name)}}function R(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"a",37),e.NdJ("click",function(){return e.CHM(t),e.oxw().editImg()}),e.TgZ(1,"span",38),e._uU(2,"Edit"),e.qZA(),e.O4$(),e.TgZ(3,"svg",39),e.TgZ(4,"g",40),e._UZ(5,"circle",41),e._UZ(6,"path",42),e.qZA(),e.qZA(),e.qZA()}}function q(r,c){1&r&&(e.TgZ(0,"p",31),e._uU(1,"please enter fee"),e.qZA())}function Y(r,c){if(1&r&&(e.TgZ(0,"p",31),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("fee must be greater then or equal to ",null==t.groupForm.controls.royaltyFee.errors||null==t.groupForm.controls.royaltyFee.errors.min?null:t.groupForm.controls.royaltyFee.errors.min.min," ")}}function j(r,c){if(1&r&&(e.TgZ(0,"p",31),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("fee must be less then or equal to ",null==t.groupForm.controls.royaltyFee.errors||null==t.groupForm.controls.royaltyFee.errors.max?null:t.groupForm.controls.royaltyFee.errors.max.max," ")}}function J(r,c){1&r&&(e.TgZ(0,"p",31),e._uU(1,"please enter description"),e.qZA())}function B(r,c){if(1&r&&(e.TgZ(0,"p",31),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("description should be greater than or equal to ",null==t.groupForm.controls.description.errors?null:t.groupForm.controls.description.errors.minlength.requiredLength," character ")}}let W=(()=>{class r{constructor(t,o,s,u,f,C,Q,z,H,$){this.authService=t,this.customDialogService=o,this.formBuilder=s,this.groupService=u,this.mediaService=f,this.http=C,this.toastr=Q,this.cf=z,this.spinner=H,this.routeService=$,this.destroy$=new T.x,this.imgFormData=new FormData,this.groupimgFormData=new FormData,this.groups$=this.groupService.groups$,this.limit=6,this.groupForm=this.formBuilder.group({name:new a.NI("",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(7)]),description:new a.NI("",[a.kI.required,a.kI.minLength(15),a.kI.maxLength(600)]),royaltyFee:new a.NI("",[a.kI.required,a.kI.min(1),a.kI.max(20)]),file:new a.NI(""),groupFile:new a.NI(""),fileName:new a.NI(""),img:new a.NI("")}),this.page=1,this._isLoading=!1,this.routeService.clubName$.pipe((0,O.x)(),(0,g.R)(this.destroy$)).subscribe(K=>{this.clubName=K,this.getGroup()})}getGroup(){this._isLoading||this.groupService.getAllGroupsByClub(this.clubName,this.page,{limit:this.limit})}onSelectFile(t){var o;if(t.target.files&&t.target.files[0]&&(this.groupFile=t.target.files[0],null===(o=this.groupForm.controls)||void 0===o||o.fileName.setValue(this.groupFile.name),t.target.files&&t.target.files[0])){const s=new FileReader;s.onload=u=>{this.cropImg(t)},s.readAsDataURL(t.target.files[0])}}cropImg(t){this.groupForm.controls.groupFile.setValue(t),this.customDialogService.showImageCropperDialog(t,1.13,!0).then(o=>{o.afterClosed().subscribe(s=>{s?(this.imageSrc=s,this.groupForm.patchValue({img:this.imageSrc})):(this.imageSrc=null,this.groupFile=null,this.groupForm.controls.img.setValue(null),this.imgFile.nativeElement.value="")})})}editImg(){this.cropImg(this.groupForm.controls.file.value)}addGroup(){this.spinner.show("main");const t=document.getElementById("group-img");I.YM(t,{canvasWidth:186,canvasHeight:162,width:186,height:162,quality:1,pixelRatio:1,skipAutoScale:!1}).then(o=>{this.groupForm.patchValue({file:this.mediaService.dataURLtoFile(o,this.groupForm.controls.name.value+".png"),groupFile:this.groupFile}),this.imgFormData.append("file",this.groupForm.get("file").value),this.groupimgFormData.append("file",this.groupForm.get("groupFile").value);const s=[];s.push(this.mediaService.uploadMedia("group",this.imgFormData)),this.imageSrc&&s.push(this.mediaService.uploadMedia("group",this.groupimgFormData)),(0,b.a)(s).pipe((0,p.q)(1),(0,n.z)(u=>{var f;if(u[0].hasErrors())return(0,v.of)(null);{const C={name:this.groupForm.controls.name.value,royaltyFee:this.groupForm.controls.royaltyFee.value,description:this.groupForm.controls.description.value,appPackageId:null===(f=this.authService.loggedInUser)||void 0===f?void 0:f.appPackageId,coverImageUrl:u[0].data.url};return u[0]&&u[1]&&!u[1].hasErrors()&&(C.groupImageUrl=u[1].data.url),this.groupService.addGroups(C)}})).subscribe(u=>{var f,C;this.spinner.hide("main"),null===u||u.hasErrors()?(this.imgFormData=new FormData,this.toastr.error(null===(C=null===(f=u.errors[0])||void 0===f?void 0:f.error)||void 0===C?void 0:C.message,"Error!")):(this.cf.detectChanges(),this.toastr.success("New group successfully added.","Success!"),this.getGroup(),this.close())})}).catch(o=>{this.toastr.warning(o,"Error!")})}numberOnly(t){const o=t.which?t.which:t.keyCode;return!(o>31&&(o<48||o>57))}close(){this.customDialogService.closeDialogs()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.e),e.Y36(l.W),e.Y36(a.qu),e.Y36(h.l),e.Y36(U.y),e.Y36(w.eN),e.Y36(_._W),e.Y36(e.sBO),e.Y36(A.t2),e.Y36(d.M))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-create-group"]],viewQuery:function(t,o){if(1&t&&e.Gf(G,5),2&t){let s;e.iGM(s=e.CRH())&&(o.imgFile=s.first)}},decls:50,vars:14,consts:[[1,"group-model"],[1,"flex","justify-end"],[1,"btn-close",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[2,"position","absolute","right","0","top","0"],["id","group-img",2,"position","relative","top","0","width","182px","text-align","center","right","0","height","162px","overflow","hidden"],[2,"background-color","#D99F3A","transform","rotate(41.3deg)","top","21%","width","300px","position","absolute","right","-50%","height","52px","font-weight","400","font-size","32px"],[1,"group-form",3,"formGroup"],["for","name"],["appTrim","","type","text","formControlName","name","maxlength","7"],["class","error-msg error",4,"ngIf"],[1,"flex","flex-col"],["class","inline-flex justify-around my-4 card-bg",4,"ngIf"],[1,"text-xl"],[1,"relative","flex","justify-between","overflow-hidden","border-2","border-gray-400","border-dashed","rounded-lg","h-14"],[1,"flex","items-center","justify-between","px-4","py-2","font-bold","bg-primary-gray-100","hover:bg-indigo-dark"],[4,"ngIf","ngIfElse"],["show",""],["fill","#FFF","height","28","viewBox","0 0 24 24","width","28","xmlns","http://www.w3.org/2000/svg",1,"m-2"],["d","M0 0h24v24H0z","fill","none"],["d","M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"],["type","file","name","","accept","image/png, image/gif, image/jpeg",1,"absolute","block","w-full","opacity-0","cursor-pointer","pin-r","pin-t",3,"change"],["imgFile",""],["class","flex items-center justify-center w-1/3 text-center cursor-pointer",3,"click",4,"ngIf"],["for","royaltyFee"],["type","text","name","royaltyFee","formControlName","royaltyFee","maxlength","2",3,"keypress"],["for","description",1,"floating-label"],["appTrim","","type","text","formControlName","description","maxlength","600"],[1,"icon","description-hide-icon"],[1,"primary-btn",3,"disabled","click"],[1,"error-msg","error"],[1,"inline-flex","justify-around","my-4","card-bg"],[1,"border-gradient-dp-p-bg-dark","hover:border-gradient-tl-p-bg-light","gradient-border-2"],["id","ticket",1,"preview",3,"src"],[1,"ml-2","font-light","text-gray-400"],[1,"w-10","ml-2","font-light","truncate"],[1,"flex","items-center","justify-center","w-1/3","text-center","cursor-pointer",3,"click"],[1,"mr-2"],["xmlns","http://www.w3.org/2000/svg","width","25","height","25","viewBox","0 0 25 25"],["id","Group_56289","data-name","Group 56289","transform","translate(11150 -4)"],["id","Ellipse_3170","data-name","Ellipse 3170","cx","12.5","cy","12.5","r","12.5","transform","translate(-11150 4)","fill","#fff"],["id","Icon_material-edit","data-name","Icon material-edit","d","M4.5,12.486v2.1H6.6l6.2-6.2-2.1-2.1Zm9.928-5.723a.558.558,0,0,0,0-.79L13.116,4.66a.558.558,0,0,0-.79,0L11.3,5.686l2.1,2.1Z","transform","translate(-11146.5 6.504)","fill","#6a6a6a"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(){return o.close()}),e.O4$(),e.TgZ(3,"svg",3),e._UZ(4,"path",4),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(5,"h1"),e.TgZ(6,"span"),e._uU(7,"Cre"),e.qZA(),e._uU(8,"ate Group"),e.qZA(),e.TgZ(9,"div",5),e.TgZ(10,"div",6),e.TgZ(11,"div",7),e._uU(12),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"form",8),e.TgZ(14,"label",9),e._uU(15,"Name"),e.qZA(),e._UZ(16,"input",10),e.YNc(17,L,2,0,"p",11),e.YNc(18,E,2,1,"p",11),e.TgZ(19,"div",12),e.YNc(20,D,3,1,"li",13),e.TgZ(21,"span",14),e._uU(22,"Select Group Image"),e.qZA(),e._UZ(23,"br"),e.TgZ(24,"div",15),e.TgZ(25,"button",16),e.YNc(26,S,3,0,"ng-container",17),e.YNc(27,N,2,1,"ng-template",null,18,e.W1O),e.TgZ(29,"div"),e.O4$(),e.TgZ(30,"svg",19),e._UZ(31,"path",20),e._UZ(32,"path",21),e.qZA(),e.qZA(),e.qZA(),e.kcU(),e.TgZ(33,"input",22,23),e.NdJ("change",function(u){return o.onSelectFile(u)}),e.qZA(),e.YNc(35,R,7,0,"a",24),e.qZA(),e.qZA(),e.TgZ(36,"label",25),e._uU(37,"Royalty Fee (%)"),e.qZA(),e.TgZ(38,"input",26),e.NdJ("keypress",function(u){return o.numberOnly(u)}),e.qZA(),e.YNc(39,q,2,0,"p",11),e.YNc(40,Y,2,1,"p",11),e.YNc(41,j,2,1,"p",11),e.TgZ(42,"label",27),e._uU(43,"Description"),e.qZA(),e._UZ(44,"textarea",28),e._UZ(45,"span",29),e.YNc(46,J,2,0,"p",11),e.YNc(47,B,2,1,"p",11),e.TgZ(48,"button",30),e.NdJ("click",function(){return o.addGroup()}),e._uU(49," Add Group "),e.qZA(),e.qZA(),e.qZA()),2&t){const s=e.MAs(28);e.xp6(12),e.hij(" ",o.groupForm.controls.name.value," "),e.xp6(1),e.Q6J("formGroup",o.groupForm),e.xp6(4),e.Q6J("ngIf",o.groupForm.controls.name.touched&&(null==o.groupForm.controls.name.errors?null:o.groupForm.controls.name.errors.required)),e.xp6(1),e.Q6J("ngIf",o.groupForm.controls.name.touched&&(null==o.groupForm.controls.name.errors?null:o.groupForm.controls.name.errors.minlength)),e.xp6(2),e.Q6J("ngIf",o.imageSrc),e.xp6(6),e.Q6J("ngIf",!o.imageSrc)("ngIfElse",s),e.xp6(9),e.Q6J("ngIf",o.imageSrc),e.xp6(4),e.Q6J("ngIf",o.groupForm.controls.royaltyFee.touched&&(null==o.groupForm.controls.royaltyFee.errors?null:o.groupForm.controls.royaltyFee.errors.required)),e.xp6(1),e.Q6J("ngIf",o.groupForm.controls.royaltyFee.touched&&(null==o.groupForm.controls.royaltyFee.errors?null:o.groupForm.controls.royaltyFee.errors.min)),e.xp6(1),e.Q6J("ngIf",o.groupForm.controls.royaltyFee.touched&&(null==o.groupForm.controls.royaltyFee.errors?null:o.groupForm.controls.royaltyFee.errors.max)),e.xp6(5),e.Q6J("ngIf",o.groupForm.controls.description.touched&&(null==o.groupForm.controls.description.errors?null:o.groupForm.controls.description.errors.required)),e.xp6(1),e.Q6J("ngIf",o.groupForm.controls.name.touched&&(null==o.groupForm.controls.description.errors?null:o.groupForm.controls.description.errors.minlength)),e.xp6(1),e.Q6J("disabled",!o.groupForm.valid)}},directives:[a._Y,a.JL,a.sg,a.Fj,y.$,a.JJ,a.u,a.nD,Z.O5],styles:[".create-group-dialog-overlay{height:auto;min-height:584px;max-width:580px!important}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.preview[_ngcontent-%COMP%]{height:6rem;width:6rem;object-fit:cover}.group-model[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding-left:0;padding-right:0}@media (min-width: 640px){.group-model[_ngcontent-%COMP%]{padding-left:4rem;padding-right:4rem}}.group-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{position:absolute;top:0px;right:0px;z-index:10;margin:.875rem;border-radius:9999px;--tw-bg-opacity: 1;background-color:rgba(255,255,255,var(--tw-bg-opacity));opacity:.5}.group-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{opacity:.7}.group-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:1px}.group-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#132356}.group-model[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:1rem;align-self:flex-start;font-size:1.875rem;line-height:2.25rem;font-weight:400}.group-model[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-bottom:4px;border-bottom:2px solid #75F16D}.group-model[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column}.group-model[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-top:1rem;padding-bottom:1rem;font-size:1.125rem;line-height:1.75rem}.group-model[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:3.5rem;padding-left:1.25rem;padding-right:1.25rem}.group-model[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:1.25rem;height:156px}.group-model[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-left:.5rem;padding-right:.5rem}.group-model[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:2rem;margin-bottom:2rem;height:2.75rem;align-self:center}"]}),r})(),k=(()=>{class r{static getCreateGroupComponent(){return W}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[Z.ez,a.u5,a.UX,M.PW,F.n,_.Rh.forRoot({positionClass:"toast-top-right"})]]}),r})()}}]);