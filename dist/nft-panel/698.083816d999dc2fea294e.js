"use strict";(self.webpackChunknft_panel=self.webpackChunknft_panel||[]).push([[698],{4515:(G,C,m)=>{m.d(C,{S:()=>L});class L{}},6658:(G,C,m)=>{m.d(C,{y:()=>D});var L=m(8583),N=m(4294),U=m(9922),F=m(2352),A=m(7716),S=m(1841),W=m(9344);let D=(()=>{class R extends F.s{constructor(b,O,d){super(O),this.document=b,this.http=O,this.toastrService=d,this.maxWidth=538,this.maxHeight=529}uploadMedia(b,O){return this.postMedia(`/media-upload/mediaFiles/${b}`,O).pipe((0,N.q)(1),(0,U.b)(d=>{var y,P;d.hasErrors()&&this.toastrService.error(null===(P=null===(y=null==d?void 0:d.errors[0])||void 0===y?void 0:y.error)||void 0===P?void 0:P.message)}))}convertToImg(b,O){return new Promise(d=>{const y=document.createElement("canvas"),P=y.getContext("2d"),p=new Image;p.src=b,p.onload=()=>{y.width=72,y.height=64,P.drawImage(p,0,0,p.width,p.height,0,0,72,64),d(this.dataURLtoFile(y.toDataURL(),O))}})}dataURLtoFile(b,O){const d=b.split(","),y=d[0].match(/:(.*?);/)[1],P=atob(d[1]);let p=P.length;const w=new Uint8Array(p);for(;p--;)w[p]=P.charCodeAt(p);return new File([w],O,{type:y})}compressImage(b){return new Promise((O,d)=>{const y=document.createElement("canvas"),P=y.getContext("2d"),p=new Image;p.src=URL.createObjectURL(b),p.onload=()=>{const w=this.calculateAspectRatioFit(null==p?void 0:p.width,null==p?void 0:p.height);y.width=w.width,y.height=w.height,P.drawImage(p,0,0,p.width,p.height,0,0,w.width,w.height),O(this.dataURLtoFile(y.toDataURL(),"thumbnail.jpg"))}})}calculateAspectRatioFit(b,O){const d=Math.min(this.maxWidth/b,this.maxHeight/O);return{width:b*d,height:O*d}}generateThumbnail(b,O){const d=this.document.createElement("video"),y=this.document.createElement("canvas"),P=document.createElement("canvas"),p=y.getContext("2d"),w=P.getContext("2d");return new Promise((K,u)=>{y.addEventListener("error",u),d.addEventListener("error",u),d.addEventListener("loadedmetadata",()=>{d.currentTime=Math.round(d.duration/2),p.drawImage(d,0,0,d.videoWidth,d.videoHeight)}),d.addEventListener("canplay",c=>{y.width=d.videoWidth,y.height=d.videoHeight,y.getContext("2d").drawImage(d,0,0,d.videoWidth,d.videoHeight);var l=new Image;l.src=y.toDataURL(),l.onload=()=>{let o=this.calculateAspectRatioFit(null==l?void 0:l.width,null==l?void 0:l.height);P.width=o.width,P.height=o.height,w.drawImage(l,0,0,l.width,l.height,0,0,o.width,o.height),K(this.dataURLtoFile(P.toDataURL(),O+".jpg"))}}),b.type&&d.setAttribute("type",b.type),d.preload="auto",d.src=window.URL.createObjectURL(b),d.load()})}}return R.\u0275fac=function(b){return new(b||R)(A.LFG(L.K0),A.LFG(S.eN),A.LFG(W._W))},R.\u0275prov=A.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})()},5761:(G,C,m)=>{m.d(C,{_:()=>p});var L=m(4515),N=m(2340),U=m(5094),F=m(1598),A=m(1964),S=m(4294),W=m(7580),D=m(9922),R=m(2352),T=m(7716),b=m(6989),O=m(1841),d=m(6658),y=m(9344),P=m(9866);let p=(()=>{class w extends R.s{constructor(u,c,l,o,a){super(c),this.customDialogService=u,this.http=c,this.mediaService=l,this.toastrService=o,this.spinner=a,this._cardCreatedSuccess$=new U.X(null),this.cardCreatedSuccess$=this._cardCreatedSuccess$.asObservable(),this._nftList=new U.X({totalCount:0,data:[]}),this.createNFTImg=new FormData,this.createNFTthumbnailImg=new FormData,this.createNFT=new L.S,this.nftList$=this._nftList.asObservable()}requestCreateNFT(u,c,l){this.spinner.show("main");const o=[];o.push(this.mediaService.uploadMedia("nft",c)),"Video"==u.mediaType&&o.push(this.mediaService.uploadMedia("nft-thumbnail",l)),(0,F.a)(o).pipe((0,S.q)(1),(0,W.z)(a=>a[0].hasErrors()?(0,A.of)(null):(console.log("res:",a),a[0]&&a[1]&&!a[1].hasErrors()&&(u.videoThumbnailUrl=a[1].data.url,console.log("res:",u.videoThumbnailUrl)),u.serverCaptureFileUrl=a[0].data.url,u.path=a[0].data.path,this.addNft(u)))).subscribe(a=>{var f,_;null==a?this.toastrService.warning(null===(_=null===(f=null==a?void 0:a.errors[0])||void 0===f?void 0:f.error)||void 0===_?void 0:_.message,"Error!"):this.customDialogService.closeDialogs(),this.spinner.hide("main")}),setTimeout(()=>{this.customDialogService.closeDialogs()},3e3)}getAllNftsByClub(u,c,l,o,a,f){const _={clubName:u,offset:--c?l*c:0,limit:l,name:o,type:f};return a&&(_.groupID=a),this.get("/nft/getAllNftsByClub",_).pipe((0,S.q)(1),(0,D.b)(g=>{var t,e;g.hasErrors()&&this.toastrService.error(null===(e=null===(t=null==g?void 0:g.errors[0])||void 0===t?void 0:t.error)||void 0===e?void 0:e.message)}))}getRecentSoldNfts(u,c,l,o,a){const f={clubName:u,offset:--c?l*c:0,limit:l};return a&&(f.type=a),o&&(f.groupID=o),this.get("/nft/getRecentSoldNfts",f).pipe((0,S.q)(1),(0,D.b)(_=>{var g,t;_.hasErrors()&&this.toastrService.error(null===(t=null===(g=null==_?void 0:_.errors[0])||void 0===g?void 0:g.error)||void 0===t?void 0:t.message)}))}getPendingForSaleNfts(u,c,l,o){const a={clubName:u,offset:--c?l*c:0,limit:l};return o.nftStatus&&(a.nftStatus=o.nftStatus),o.price&&(a.price=o.price),o.tokenId&&(a.tokenId=o.tokenId),this.get("/nft/getPendingForSaleNfts",a).pipe((0,S.q)(1),(0,D.b)(f=>{var _,g;f.hasErrors()&&this.toastrService.error(null===(g=null===(_=null==f?void 0:f.errors[0])||void 0===_?void 0:_.error)||void 0===g?void 0:g.message)}))}getAllNftsByUser(u,c,l,o,a,f){const _={clubName:u,offset:--l?N.N.limit*l:0,limit:N.N.limit,name:o,type:f};return a&&(_.groupID=a),this.get("/nft/getUserNftsByClub/"+c,_).pipe((0,S.q)(1),(0,D.b)(g=>{var t,e;g.hasErrors()&&this.toastrService.error(null===(e=null===(t=null==g?void 0:g.errors[0])||void 0===t?void 0:t.error)||void 0===e?void 0:e.message)}))}getAllNftsAdminPanel(u,c,l,o){const a={clubName:u,offset:--c?N.N.limit*c:0,limit:N.N.limit,name:l};return o.nftStatus&&(a.nftStatus=o.nftStatus),o.price&&(a.price=o.price),o.tokenId&&(a.tokenId=o.tokenId),o.type&&(a.type=o.type),this.get("/nft/getNftsByAppPackageIdForAdminPanel",a).pipe((0,S.q)(1),(0,D.b)(f=>{var _,g;f.hasErrors()&&this.toastrService.error(null===(g=null===(_=null==f?void 0:f.errors[0])||void 0===_?void 0:_.error)||void 0===g?void 0:g.message)}))}getNft(u){return this.get("/nft/getNft/"+u).pipe((0,S.q)(1),(0,D.b)(l=>{var o,a;l.hasErrors()&&this.toastrService.error(null===(a=null===(o=null==l?void 0:l.errors[0])||void 0===o?void 0:o.error)||void 0===a?void 0:a.message)}))}updateNft(u,c){return this.post("/nft/updateNft/"+u,{nftStatus:c}).pipe((0,S.q)(1),(0,D.b)(o=>{var a,f;o.hasErrors()&&this.toastrService.error(null===(f=null===(a=null==o?void 0:o.errors[0])||void 0===a?void 0:a.error)||void 0===f?void 0:f.message)}))}allUpdateNft(u,c){return this.post("/nft/updateAllNfts/",{nftStatus:u,appPackageId:c}).pipe((0,S.q)(1),(0,D.b)(o=>{var a,f;o.hasErrors()&&this.toastrService.error(null===(f=null===(a=null==o?void 0:o.errors[0])||void 0===a?void 0:a.error)||void 0===f?void 0:f.message)}))}batchUpdateNft(u,c,l){return this.post("/nft/updateMultipleNfts/",{nftStatus:c,nftArray:u,appPackageId:l}).pipe((0,S.q)(1),(0,D.b)(a=>{var f,_;a.hasErrors()&&this.toastrService.error(null===(_=null===(f=null==a?void 0:a.errors[0])||void 0===f?void 0:f.error)||void 0===_?void 0:_.message)}))}getEventsByNft(u){return this.get("/event/getEventByNftId/"+u).pipe((0,S.q)(1),(0,D.b)(l=>{var o,a;l.hasErrors()&&this.toastrService.error(null===(a=null===(o=null==l?void 0:l.errors[0])||void 0===o?void 0:o.error)||void 0===a?void 0:a.message)}))}getEventsByUser(u,c,l,o,a,f){const _={offset:--c?l*c:0,limit:l,eventType:f};return a&&(_.groupID=a),o&&(_.date=o),this.get("/event/getEventByUserId/"+u,_).pipe((0,S.q)(1),(0,D.b)(g=>{var t,e;g.hasErrors()&&this.toastrService.error(null===(e=null===(t=null==g?void 0:g.errors[0])||void 0===t?void 0:t.error)||void 0===e?void 0:e.message)}))}isMembershipIDExists(u){return this.post("/nft/isMembershipIDExists",u)}addNft(u){return this.post("/nft/addNft",u).pipe((0,S.q)(1),(0,D.b)(c=>{var l,o,a;c.hasErrors()?this.toastrService.error(null===(o=null===(l=null==c?void 0:c.errors[0])||void 0===l?void 0:l.error)||void 0===o?void 0:o.message):(null==c?void 0:c.data)&&(u.freezeNft&&(this.customDialogService.showLoadingDialog("Minting In Process"),setTimeout(()=>{this.customDialogService.closeDialogs()},3e3)),this._cardCreatedSuccess$.next(null===(a=null==c?void 0:c.data)||void 0===a?void 0:a.id))}))}updateNftResaleStatus(u,c,l){const o={isResaleAvailable:c};return c&&(o.price=l),this.post("/nft/updateOwnedNft/"+u,o).pipe((0,S.q)(1))}}return w.\u0275fac=function(u){return new(u||w)(T.LFG(b.W),T.LFG(O.eN),T.LFG(d.y),T.LFG(y._W),T.LFG(P.t2))},w.\u0275prov=T.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()},4762:(G,C,m)=>{function D(t,e,r,n){return new(r||(r=Promise))(function(i,v){function E(M){try{h(n.next(M))}catch(j){v(j)}}function x(M){try{h(n.throw(M))}catch(j){v(j)}}function h(M){M.done?i(M.value):function(i){return i instanceof r?i:new r(function(v){v(i)})}(M.value).then(E,x)}h((n=n.apply(t,e||[])).next())})}m.d(C,{mG:()=>D})}}]);