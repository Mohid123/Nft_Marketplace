"use strict";(self.webpackChunknft_panel=self.webpackChunknft_panel||[]).push([[683],{4515:($,N,_)=>{_.d(N,{S:()=>a});class a{}},6658:($,N,_)=>{_.d(N,{y:()=>z});var a=_(8583),H=_(4294),F=_(9922),j=_(2352),k=_(7716),b=_(1841),K=_(9344);let z=(()=>{class D extends j.s{constructor(S,y,f){super(y),this.document=S,this.http=y,this.toastrService=f,this.maxWidth=538,this.maxHeight=529}uploadMedia(S,y){return this.postMedia(`/media-upload/mediaFiles/${S}`,y).pipe((0,H.q)(1),(0,F.b)(f=>{var w,R;f.hasErrors()&&this.toastrService.error(null===(R=null===(w=null==f?void 0:f.errors[0])||void 0===w?void 0:w.error)||void 0===R?void 0:R.message)}))}convertToImg(S,y){return new Promise(f=>{const w=document.createElement("canvas"),R=w.getContext("2d"),v=new Image;v.src=S,v.onload=()=>{w.width=72,w.height=64,R.drawImage(v,0,0,v.width,v.height,0,0,72,64),f(this.dataURLtoFile(w.toDataURL(),y))}})}dataURLtoFile(S,y){const f=S.split(","),w=f[0].match(/:(.*?);/)[1],R=atob(f[1]);let v=R.length;const E=new Uint8Array(v);for(;v--;)E[v]=R.charCodeAt(v);return new File([E],y,{type:w})}compressImage(S){return new Promise((y,f)=>{const w=document.createElement("canvas"),R=w.getContext("2d"),v=new Image;v.src=URL.createObjectURL(S),v.onload=()=>{const E=this.calculateAspectRatioFit(null==v?void 0:v.width,null==v?void 0:v.height);w.width=E.width,w.height=E.height,R.drawImage(v,0,0,v.width,v.height,0,0,E.width,E.height),y(this.dataURLtoFile(w.toDataURL(),"thumbnail.jpg"))}})}calculateAspectRatioFit(S,y){const f=Math.min(this.maxWidth/S,this.maxHeight/y);return{width:S*f,height:y*f}}generateThumbnail(S,y){const f=this.document.createElement("video"),w=this.document.createElement("canvas"),R=document.createElement("canvas"),v=w.getContext("2d"),E=R.getContext("2d");return new Promise((X,m)=>{w.addEventListener("error",m),f.addEventListener("error",m),f.addEventListener("loadedmetadata",()=>{f.currentTime=Math.round(f.duration/2),v.drawImage(f,0,0,f.videoWidth,f.videoHeight)}),f.addEventListener("canplay",g=>{w.width=f.videoWidth,w.height=f.videoHeight,w.getContext("2d").drawImage(f,0,0,f.videoWidth,f.videoHeight);var d=new Image;d.src=w.toDataURL(),d.onload=()=>{let h=this.calculateAspectRatioFit(null==d?void 0:d.width,null==d?void 0:d.height);R.width=h.width,R.height=h.height,E.drawImage(d,0,0,d.width,d.height,0,0,h.width,h.height),X(this.dataURLtoFile(R.toDataURL(),y+".jpg"))}}),S.type&&f.setAttribute("type",S.type),f.preload="auto",f.src=window.URL.createObjectURL(S),f.load()})}}return D.\u0275fac=function(S){return new(S||D)(k.LFG(a.K0),k.LFG(b.eN),k.LFG(K._W))},D.\u0275prov=k.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},5761:($,N,_)=>{_.d(N,{_:()=>v});var a=_(4515),H=_(2340),F=_(5094),j=_(1598),k=_(1964),b=_(4294),K=_(7580),z=_(9922),D=_(2352),B=_(7716),S=_(6989),y=_(1841),f=_(6658),w=_(9344),R=_(9866);let v=(()=>{class E extends D.s{constructor(m,g,d,h,p){super(g),this.customDialogService=m,this.http=g,this.mediaService=d,this.toastrService=h,this.spinner=p,this._cardCreatedSuccess$=new F.X(null),this.cardCreatedSuccess$=this._cardCreatedSuccess$.asObservable(),this._nftList=new F.X({totalCount:0,data:[]}),this.createNFTImg=new FormData,this.createNFTthumbnailImg=new FormData,this.createNFT=new a.S,this.nftList$=this._nftList.asObservable()}requestCreateNFT(m,g,d){this.spinner.show("main");const h=[];h.push(this.mediaService.uploadMedia("nft",g)),"Video"==m.mediaType&&h.push(this.mediaService.uploadMedia("nft-thumbnail",d)),(0,j.a)(h).pipe((0,b.q)(1),(0,K.z)(p=>p[0].hasErrors()?(0,k.of)(null):(console.log("res:",p),p[0]&&p[1]&&!p[1].hasErrors()&&(m.videoThumbnailUrl=p[1].data.url,console.log("res:",m.videoThumbnailUrl)),m.serverCaptureFileUrl=p[0].data.url,m.path=p[0].data.path,this.addNft(m)))).subscribe(p=>{var u,x;null==p?this.toastrService.warning(null===(x=null===(u=null==p?void 0:p.errors[0])||void 0===u?void 0:u.error)||void 0===x?void 0:x.message,"Error!"):this.customDialogService.closeDialogs(),this.spinner.hide("main")}),setTimeout(()=>{this.customDialogService.closeDialogs()},3e3)}getAllNftsByClub(m,g,d,h,p,u){const x={clubName:m,offset:--g?d*g:0,limit:d,name:h,type:u};return p&&(x.groupID=p),this.get("/nft/getAllNftsByClub",x).pipe((0,b.q)(1),(0,z.b)(M=>{var O,W;M.hasErrors()&&this.toastrService.error(null===(W=null===(O=null==M?void 0:M.errors[0])||void 0===O?void 0:O.error)||void 0===W?void 0:W.message)}))}getRecentSoldNfts(m,g,d,h,p){const u={clubName:m,offset:--g?d*g:0,limit:d};return p&&(u.type=p),h&&(u.groupID=h),this.get("/nft/getRecentSoldNfts",u).pipe((0,b.q)(1),(0,z.b)(x=>{var M,O;x.hasErrors()&&this.toastrService.error(null===(O=null===(M=null==x?void 0:x.errors[0])||void 0===M?void 0:M.error)||void 0===O?void 0:O.message)}))}getPendingForSaleNfts(m,g,d,h){const p={clubName:m,offset:--g?d*g:0,limit:d};return h.nftStatus&&(p.nftStatus=h.nftStatus),h.price&&(p.price=h.price),h.tokenId&&(p.tokenId=h.tokenId),this.get("/nft/getPendingForSaleNfts",p).pipe((0,b.q)(1),(0,z.b)(u=>{var x,M;u.hasErrors()&&this.toastrService.error(null===(M=null===(x=null==u?void 0:u.errors[0])||void 0===x?void 0:x.error)||void 0===M?void 0:M.message)}))}getAllNftsByUser(m,g,d,h,p,u){const x={clubName:m,offset:--d?H.N.limit*d:0,limit:H.N.limit,name:h,type:u};return p&&(x.groupID=p),this.get("/nft/getUserNftsByClub/"+g,x).pipe((0,b.q)(1),(0,z.b)(M=>{var O,W;M.hasErrors()&&this.toastrService.error(null===(W=null===(O=null==M?void 0:M.errors[0])||void 0===O?void 0:O.error)||void 0===W?void 0:W.message)}))}getAllNftsAdminPanel(m,g,d,h){const p={clubName:m,offset:--g?H.N.limit*g:0,limit:H.N.limit,name:d};return h.nftStatus&&(p.nftStatus=h.nftStatus),h.price&&(p.price=h.price),h.tokenId&&(p.tokenId=h.tokenId),h.type&&(p.type=h.type),this.get("/nft/getNftsByAppPackageIdForAdminPanel",p).pipe((0,b.q)(1),(0,z.b)(u=>{var x,M;u.hasErrors()&&this.toastrService.error(null===(M=null===(x=null==u?void 0:u.errors[0])||void 0===x?void 0:x.error)||void 0===M?void 0:M.message)}))}getNft(m){return this.get("/nft/getNft/"+m).pipe((0,b.q)(1),(0,z.b)(d=>{var h,p;d.hasErrors()&&this.toastrService.error(null===(p=null===(h=null==d?void 0:d.errors[0])||void 0===h?void 0:h.error)||void 0===p?void 0:p.message)}))}updateNft(m,g){return this.post("/nft/updateNft/"+m,{nftStatus:g}).pipe((0,b.q)(1),(0,z.b)(h=>{var p,u;h.hasErrors()&&this.toastrService.error(null===(u=null===(p=null==h?void 0:h.errors[0])||void 0===p?void 0:p.error)||void 0===u?void 0:u.message)}))}allUpdateNft(m,g){return this.post("/nft/updateAllNfts/",{nftStatus:m,appPackageId:g}).pipe((0,b.q)(1),(0,z.b)(h=>{var p,u;h.hasErrors()&&this.toastrService.error(null===(u=null===(p=null==h?void 0:h.errors[0])||void 0===p?void 0:p.error)||void 0===u?void 0:u.message)}))}batchUpdateNft(m,g,d){return this.post("/nft/updateMultipleNfts/",{nftStatus:g,nftArray:m,appPackageId:d}).pipe((0,b.q)(1),(0,z.b)(p=>{var u,x;p.hasErrors()&&this.toastrService.error(null===(x=null===(u=null==p?void 0:p.errors[0])||void 0===u?void 0:u.error)||void 0===x?void 0:x.message)}))}getEventsByNft(m){return this.get("/event/getEventByNftId/"+m).pipe((0,b.q)(1),(0,z.b)(d=>{var h,p;d.hasErrors()&&this.toastrService.error(null===(p=null===(h=null==d?void 0:d.errors[0])||void 0===h?void 0:h.error)||void 0===p?void 0:p.message)}))}getEventsByUser(m,g,d,h,p,u){const x={offset:--g?d*g:0,limit:d,eventType:u};return p&&(x.groupID=p),h&&(x.date=h),this.get("/event/getEventByUserId/"+m,x).pipe((0,b.q)(1),(0,z.b)(M=>{var O,W;M.hasErrors()&&this.toastrService.error(null===(W=null===(O=null==M?void 0:M.errors[0])||void 0===O?void 0:O.error)||void 0===W?void 0:W.message)}))}isMembershipIDExists(m){return this.post("/nft/isMembershipIDExists",m)}addNft(m){return this.post("/nft/addNft",m).pipe((0,b.q)(1),(0,z.b)(g=>{var d,h,p;g.hasErrors()?this.toastrService.error(null===(h=null===(d=null==g?void 0:g.errors[0])||void 0===d?void 0:d.error)||void 0===h?void 0:h.message):(null==g?void 0:g.data)&&(m.freezeNft&&(this.customDialogService.showLoadingDialog("Minting In Process"),setTimeout(()=>{this.customDialogService.closeDialogs()},3e3)),this._cardCreatedSuccess$.next(null===(p=null==g?void 0:g.data)||void 0===p?void 0:p.id))}))}updateNftResaleStatus(m,g,d){const h={isResaleAvailable:g};return g&&(h.price=d),this.post("/nft/updateOwnedNft/"+m,h).pipe((0,b.q)(1))}}return E.\u0275fac=function(m){return new(m||E)(B.LFG(S.W),B.LFG(y.eN),B.LFG(f.y),B.LFG(w._W),B.LFG(R.t2))},E.\u0275prov=B.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},6683:($,N,_)=>{_.r(N),_.d(N,{ImageCropModule:()=>lt});var a=_(7716),H=_(4762),F=_(8583),j=_(9075);const k=["wrapper"],b=["sourceImage"];function K(s,c){if(1&s){const t=a.EpF();a.TgZ(0,"img",4,5),a.NdJ("load",function(){return a.CHM(t),a.oxw().imageLoadedInView()}),a.qZA()}if(2&s){const t=a.oxw();a.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),a.Q6J("src",t.safeImgDataUrl,a.LSH)}}function z(s,c){if(1&s){const t=a.EpF();a.ynx(0),a.TgZ(1,"span",9),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"topleft")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"topleft")}),a._UZ(2,"span",10),a.qZA(),a.TgZ(3,"span",11),a._UZ(4,"span",10),a.qZA(),a.TgZ(5,"span",12),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"topright")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"topright")}),a._UZ(6,"span",10),a.qZA(),a.TgZ(7,"span",13),a._UZ(8,"span",10),a.qZA(),a.TgZ(9,"span",14),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"bottomright")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"bottomright")}),a._UZ(10,"span",10),a.qZA(),a.TgZ(11,"span",15),a._UZ(12,"span",10),a.qZA(),a.TgZ(13,"span",16),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"bottomleft")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"bottomleft")}),a._UZ(14,"span",10),a.qZA(),a.TgZ(15,"span",17),a._UZ(16,"span",10),a.qZA(),a.TgZ(17,"span",18),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"top")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"top")}),a.qZA(),a.TgZ(18,"span",19),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"right")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"right")}),a.qZA(),a.TgZ(19,"span",20),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"bottom")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"bottom")}),a.qZA(),a.TgZ(20,"span",21),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"left")})("touchstart",function(i){a.CHM(t);const o=a.oxw(2);return o.startMove(i,o.moveTypes.Resize,"left")}),a.qZA(),a.BQk()}}function D(s,c){if(1&s){const t=a.EpF();a.TgZ(0,"div",6),a.NdJ("keydown",function(i){return a.CHM(t),a.oxw().keyboardAccess(i)}),a.TgZ(1,"div",7),a.NdJ("mousedown",function(i){a.CHM(t);const o=a.oxw();return o.startMove(i,o.moveTypes.Move)})("touchstart",function(i){a.CHM(t);const o=a.oxw();return o.startMove(i,o.moveTypes.Move)}),a.qZA(),a.YNc(2,z,21,0,"ng-container",8),a.qZA()}if(2&s){const t=a.oxw();a.Udp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),a.ekj("ngx-ic-round",t.roundCropper),a.xp6(2),a.Q6J("ngIf",!t.hideResizeSquares)}}class B{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=void 0,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t]),this.validateOptions()}setOptionsFromChanges(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}const y={Move:"move",Resize:"resize",Pinch:"pinch"};let w=(()=>{class s{crop(t,e,i,o){const r=this.getImagePosition(t,e,i,o),n=r.x2-r.x1,l=r.y2-r.y1,C=document.createElement("canvas");C.width=n,C.height=l;const A=C.getContext("2d");if(!A)return;null!=o.backgroundColor&&(A.fillStyle=o.backgroundColor,A.fillRect(0,0,n,l));const I=(o.transform.scale||1)*(o.transform.flipH?-1:1),P=(o.transform.scale||1)*(o.transform.flipV?-1:1),U=e.transformed;A.setTransform(I,0,0,P,U.size.width/2,U.size.height/2),A.translate(-r.x1/I,-r.y1/P),A.rotate((o.transform.rotate||0)*Math.PI/180),A.drawImage(U.image,-U.size.width/2,-U.size.height/2);const T={width:n,height:l,imagePosition:r,cropperPosition:Object.assign({},i)};o.containWithinAspectRatio&&(T.offsetImagePosition=this.getOffsetImagePosition(t,e,i,o));const L=this.getResizeRatio(n,l,o);return 1!==L&&(T.width=Math.round(n*L),T.height=o.maintainAspectRatio?Math.round(T.width/o.aspectRatio):Math.round(l*L),function(s,c,t){const e=s.width,i=s.height,o=e/(c=Math.round(c)),r=i/(t=Math.round(t)),n=Math.ceil(o/2),l=Math.ceil(r/2),C=s.getContext("2d");if(C){const A=C.getImageData(0,0,e,i),I=C.createImageData(c,t),P=A.data,U=I.data;for(let T=0;T<t;T++)for(let L=0;L<c;L++){const J=4*(L+T*c),mt=T*r;let Q=0,V=0,it=0,at=0,ot=0,rt=0,nt=0;const ft=Math.floor(L*o),ut=Math.floor(T*r);let tt=Math.ceil((L+1)*o),et=Math.ceil((T+1)*r);tt=Math.min(tt,e),et=Math.min(et,i);for(let q=ut;q<et;q++){const st=Math.abs(mt-q)/l,_t=L*o,xt=st*st;for(let G=ft;G<tt;G++){const ct=Math.abs(_t-G)/n,Z=Math.sqrt(xt+ct*ct);if(Z>=1)continue;Q=2*Z*Z*Z-3*Z*Z+1;const Y=4*(G+q*e);nt+=Q*P[Y+3],it+=Q,P[Y+3]<255&&(Q=Q*P[Y+3]/250),at+=Q*P[Y],ot+=Q*P[Y+1],rt+=Q*P[Y+2],V+=Q}}U[J]=at/V,U[J+1]=ot/V,U[J+2]=rt/V,U[J+3]=nt/it}s.width=c,s.height=t,C.putImageData(I,0,0)}}(C,T.width,T.height)),T.base64=C.toDataURL("image/"+o.format,this.getQuality(o)),T}getImagePosition(t,e,i,o){const n=e.transformed.size.width/t.nativeElement.offsetWidth,l={x1:Math.round(i.x1*n),y1:Math.round(i.y1*n),x2:Math.round(i.x2*n),y2:Math.round(i.y2*n)};return o.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,e.transformed.size.width),l.y2=Math.min(l.y2,e.transformed.size.height)),l}getOffsetImagePosition(t,e,i,o){const l=e.transformed.size.width/t.nativeElement.offsetWidth;let C,A;(o.canvasRotation+e.exifTransform.rotate)%2?(C=(e.transformed.size.width-e.original.size.height)/2,A=(e.transformed.size.height-e.original.size.width)/2):(C=(e.transformed.size.width-e.original.size.width)/2,A=(e.transformed.size.height-e.original.size.height)/2);const I={x1:Math.round(i.x1*l)-C,y1:Math.round(i.y1*l)-A,x2:Math.round(i.x2*l)-C,y2:Math.round(i.y2*l)-A};return o.containWithinAspectRatio||(I.x1=Math.max(I.x1,0),I.y1=Math.max(I.y1,0),I.x2=Math.min(I.x2,e.transformed.size.width),I.y2=Math.min(I.y2,e.transformed.size.height)),I}getResizeRatio(t,e,i){const o=i.resizeToWidth/t,r=i.resizeToHeight/e,n=new Array;i.resizeToWidth>0&&n.push(o),i.resizeToHeight>0&&n.push(r);const l=0===n.length?1:Math.min(...n);return l>1&&!i.onlyScaleDown?l:Math.min(l,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=(0,a.Yz7)({factory:function(){return new s},token:s,providedIn:"root"}),s})(),R=(()=>{class s{resetCropperPosition(t,e,i){if(!(null==t?void 0:t.nativeElement))return;const o=t.nativeElement;if(i.cropperStaticHeight&&i.cropperStaticWidth)e.x1=0,e.x2=o.offsetWidth>i.cropperStaticWidth?i.cropperStaticWidth:o.offsetWidth,e.y1=0,e.y2=o.offsetHeight>i.cropperStaticHeight?i.cropperStaticHeight:o.offsetHeight;else{const r=Math.min(i.cropperScaledMaxWidth,o.offsetWidth),n=Math.min(i.cropperScaledMaxHeight,o.offsetHeight);if(i.maintainAspectRatio)if(o.offsetWidth/i.aspectRatio<o.offsetHeight){e.x1=0,e.x2=r;const l=r/i.aspectRatio;e.y1=(o.offsetHeight-l)/2,e.y2=e.y1+l}else{e.y1=0,e.y2=n;const l=n*i.aspectRatio;e.x1=(o.offsetWidth-l)/2,e.x2=e.x1+l}else e.x1=0,e.x2=r,e.y1=0,e.y2=n}}move(t,e,i){const o=this.getClientX(t)-e.clientX,r=this.getClientY(t)-e.clientY;i.x1=e.x1+o,i.y1=e.y1+r,i.x2=e.x2+o,i.y2=e.y2+r}resize(t,e,i,o,r){const n=this.getClientX(t)-e.clientX,l=this.getClientY(t)-e.clientY;switch(e.position){case"left":i.x1=Math.min(Math.max(e.x1+n,i.x2-r.cropperScaledMaxWidth),i.x2-r.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(e.x1+n,i.x2-r.cropperScaledMaxWidth),i.x2-r.cropperScaledMinWidth),i.y1=Math.min(Math.max(e.y1+l,i.y2-r.cropperScaledMaxHeight),i.y2-r.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(e.y1+l,i.y2-r.cropperScaledMaxHeight),i.y2-r.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(e.x2+n,i.x1+r.cropperScaledMaxWidth),i.x1+r.cropperScaledMinWidth),i.y1=Math.min(Math.max(e.y1+l,i.y2-r.cropperScaledMaxHeight),i.y2-r.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(e.x2+n,i.x1+r.cropperScaledMaxWidth),i.x1+r.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(e.x2+n,i.x1+r.cropperScaledMaxWidth),i.x1+r.cropperScaledMinWidth),i.y2=Math.max(Math.min(e.y2+l,i.y1+r.cropperScaledMaxHeight),i.y1+r.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(e.y2+l,i.y1+r.cropperScaledMaxHeight),i.y1+r.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(e.x1+n,i.x2-r.cropperScaledMaxWidth),i.x2-r.cropperScaledMinWidth),i.y2=Math.max(Math.min(e.y2+l,i.y1+r.cropperScaledMaxHeight),i.y1+r.cropperScaledMinHeight);break;case"center":const C=t.scale,A=Math.min(Math.max(r.cropperScaledMinWidth,Math.abs(e.x2-e.x1)*C),r.cropperScaledMaxWidth),I=Math.min(Math.max(r.cropperScaledMinHeight,Math.abs(e.y2-e.y1)*C),r.cropperScaledMaxHeight);i.x1=e.clientX-A/2,i.x2=e.clientX+A/2,i.y1=e.clientY-I/2,i.y2=e.clientY+I/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>o.width&&(i.x1-=i.x2-o.width,i.x2=o.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>o.height&&(i.y1-=i.y2-o.height,i.y2=o.height)}r.maintainAspectRatio&&this.checkAspectRatio(e.position,i,o,r)}checkAspectRatio(t,e,i,o){let r=0,n=0;switch(t){case"top":e.x2=e.x1+(e.y2-e.y1)*o.aspectRatio,r=Math.max(e.x2-i.width,0),n=Math.max(0-e.y1,0),(r>0||n>0)&&(e.x2-=n*o.aspectRatio>r?n*o.aspectRatio:r,e.y1+=n*o.aspectRatio>r?n:r/o.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*o.aspectRatio,r=Math.max(e.x2-i.width,0),n=Math.max(e.y2-i.height,0),(r>0||n>0)&&(e.x2-=n*o.aspectRatio>r?n*o.aspectRatio:r,e.y2-=n*o.aspectRatio>r?n:r/o.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/o.aspectRatio,r=Math.max(0-e.x1,0),n=Math.max(0-e.y1,0),(r>0||n>0)&&(e.x1+=n*o.aspectRatio>r?n*o.aspectRatio:r,e.y1+=n*o.aspectRatio>r?n:r/o.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/o.aspectRatio,r=Math.max(e.x2-i.width,0),n=Math.max(0-e.y1,0),(r>0||n>0)&&(e.x2-=n*o.aspectRatio>r?n*o.aspectRatio:r,e.y1+=n*o.aspectRatio>r?n:r/o.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/o.aspectRatio,r=Math.max(e.x2-i.width,0),n=Math.max(e.y2-i.height,0),(r>0||n>0)&&(e.x2-=n*o.aspectRatio>r?n*o.aspectRatio:r,e.y2-=n*o.aspectRatio>r?n:r/o.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/o.aspectRatio,r=Math.max(0-e.x1,0),n=Math.max(e.y2-i.height,0),(r>0||n>0)&&(e.x1+=n*o.aspectRatio>r?n*o.aspectRatio:r,e.y2-=n*o.aspectRatio>r?n:r/o.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*o.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/o.aspectRatio;const l=Math.max(0-e.x1,0),C=Math.max(e.x2-i.width,0),A=Math.max(e.y2-i.height,0),I=Math.max(0-e.y1,0);(l>0||C>0||A>0||I>0)&&(e.x1+=A*o.aspectRatio>l?A*o.aspectRatio:l,e.x2-=I*o.aspectRatio>C?I*o.aspectRatio:C,e.y1+=I*o.aspectRatio>C?I:C/o.aspectRatio,e.y2-=A*o.aspectRatio>l?A:l/o.aspectRatio)}}getClientX(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e[0].clientX)||t.clientX||0}getClientY(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e[0].clientY)||t.clientY||0}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=(0,a.Yz7)({factory:function(){return new s},token:s,providedIn:"root"}),s})();let h=(()=>{class s{constructor(){this.autoRotateSupported=new Promise(s=>{const c=new Image;c.onload=()=>{s(1===c.width&&2===c.height)},c.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}loadImageFile(t,e){return new Promise((i,o)=>{const r=new FileReader;r.onload=n=>{this.loadImage(n.target.result,t.type,e).then(i).catch(o)},r.readAsDataURL(t)})}loadImage(t,e,i){return this.isValidImageType(e)?this.loadBase64Image(t,i):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp)/.test(t)}loadImageFromURL(t,e){return new Promise((i,o)=>{const r=new Image;r.onerror=()=>o,r.onload=()=>{const n=document.createElement("canvas"),l=n.getContext("2d");n.width=r.width,n.height=r.height,l.drawImage(r,0,0),this.loadBase64Image(n.toDataURL(),e).then(i)},r.crossOrigin="anonymous",r.src=t})}loadBase64Image(t,e){return new Promise((i,o)=>{const r=new Image;r.onload=()=>i({originalImage:r,originalBase64:t}),r.onerror=o,r.src=t}).then(i=>this.transformImageBase64(i,e))}transformImageBase64(t,e){return(0,H.mG)(this,void 0,void 0,function*(){const i=yield this.autoRotateSupported,o=yield function(s){switch("string"==typeof s&&(s=function(s){const c=new DataView(function(s){s=s.replace(/^data\:([^\;]+)\;base64,/gim,"");const c=atob(s),t=c.length,e=new Uint8Array(t);for(let i=0;i<t;i++)e[i]=c.charCodeAt(i);return e.buffer}(s));if(65496!==c.getUint16(0,!1))return-2;const t=c.byteLength;let e=2;for(;e<t;){if(c.getUint16(e+2,!1)<=8)return-1;const i=c.getUint16(e,!1);if(e+=2,65505==i){if(1165519206!==c.getUint32(e+=2,!1))return-1;const o=18761==c.getUint16(e+=6,!1);e+=c.getUint32(e+4,o);const r=c.getUint16(e,o);e+=2;for(let n=0;n<r;n++)if(274==c.getUint16(e+12*n,o))return c.getUint16(e+12*n+8,o)}else{if(65280!=(65280&i))break;e+=c.getUint16(e,!1)}}return-1}(s)),s){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(i?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?this.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:o},e):Promise.reject(new Error("No image loaded"))})}transformLoadedImage(t,e){return(0,H.mG)(this,void 0,void 0,function*(){const i=e.canvasRotation+t.exifTransform.rotate,o={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===i&&!t.exifTransform.flip&&!e.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},transformed:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},exifTransform:t.exifTransform};const r=this.getTransformedSize(o,t.exifTransform,e),n=document.createElement("canvas");n.width=r.width,n.height=r.height;const l=n.getContext("2d");l.setTransform(t.exifTransform.flip?-1:1,0,0,1,n.width/2,n.height/2),l.rotate(Math.PI*(i/2)),l.drawImage(t.original.image,-o.width/2,-o.height/2);const C=n.toDataURL(),A=yield this.loadImageFromBase64(C);return{original:{base64:t.original.base64,image:t.original.image,size:Object.assign({},o)},transformed:{base64:C,image:A,size:{width:A.width,height:A.height}},exifTransform:t.exifTransform}})}loadImageFromBase64(t){return new Promise((e,i)=>{const o=new Image;o.onload=()=>e(o),o.onerror=i,o.src=t})}getTransformedSize(t,e,i){const o=i.canvasRotation+e.rotate;if(i.containWithinAspectRatio){if(o%2){const n=t.height/i.aspectRatio;return{width:Math.max(t.height,t.width*i.aspectRatio),height:Math.max(t.width,n)}}{const n=t.width/i.aspectRatio;return{width:Math.max(t.width,t.height*i.aspectRatio),height:Math.max(t.height,n)}}}return o%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=(0,a.Yz7)({factory:function(){return new s},token:s,providedIn:"root"}),s})(),M=(()=>{class s{constructor(t,e,i,o,r){this.cropService=t,this.cropperPositionService=e,this.loadImageService=i,this.sanitizer=o,this.cd=r,this.Hammer=(null==window?void 0:window.Hammer)||null,this.settings=new B,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.moveTypes=y,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new a.vpe,this.startCropImage=new a.vpe,this.imageLoaded=new a.vpe,this.cropperReady=new a.vpe,this.loadImageFailed=new a.vpe,this.reset()}ngOnChanges(t){var e;this.onChangesUpdateSettings(t),this.onChangesInputImage(t),(null===(e=this.loadedImage)||void 0===e?void 0:e.original.image.complete)&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(t.maintainAspectRatio||t.aspectRatio)?this.resetCropperPosition():t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){var t,e,i;return(null===(i=null===(e=null===(t=this.imageChangedEvent)||void 0===t?void 0:t.target)||void 0===e?void 0:e.files)||void 0===i?void 0:i.length)>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=null,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(e=>this.setLoadedImage(e)).catch(e=>this.loadImageError(e))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(Object.assign({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){var t,e;return(null===(e=null===(t=this.sourceImage)||void 0===t?void 0:t.nativeElement)||void 0===e?void 0:e.offsetWidth)>0}onResize(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,a.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const e=+t.key;e>=1&&e<=9&&(this.settings.stepSize=e)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const i=t.shiftKey?y.Resize:y.Move,o=t.altKey?function(s){switch(s){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}(t.key):function(s){switch(s){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}(t.key),r=function(s,c){switch(s){case"ArrowUp":return{clientX:0,clientY:-1*c};case"ArrowRight":return{clientX:c,clientY:0};case"ArrowDown":return{clientX:0,clientY:c};case"ArrowLeft":default:return{clientX:-1*c,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},i,o),this.moveImg(r),this.moveStop()}startMove(t,e,i=null){var o,r;(null===(o=this.moveStart)||void 0===o?void 0:o.active)&&(null===(r=this.moveStart)||void 0===r?void 0:r.type)===y.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:e,position:i,clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t)},this.cropper))}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart=Object.assign({active:!0,type:y.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}moveImg(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===y.Move?(this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===y.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===y.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){var t,e;(null===(e=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===e?void 0:e.image)?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){var t,e;if(null===(e=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===e?void 0:e.image){const i=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/i:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/i:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){var t,e;if(null!=(null===(e=null===(t=this.loadedImage)||void 0===t?void 0:t.transformed)||void 0===e?void 0:e.image)){this.startCropImage.emit();const i=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=i&&this.imageCropped.emit(i),i}return null}}return s.\u0275fac=function(t){return new(t||s)(a.Y36(w),a.Y36(R),a.Y36(h),a.Y36(j.H7),a.Y36(a.sBO))},s.\u0275cmp=a.Xpm({type:s,selectors:[["image-cropper"]],viewQuery:function(t,e){if(1&t&&(a.Gf(k,7),a.Gf(b,5)),2&t){let i;a.iGM(i=a.CRH())&&(e.wrapper=i.first),a.iGM(i=a.CRH())&&(e.sourceImage=i.first)}},hostVars:4,hostBindings:function(t,e){1&t&&a.NdJ("resize",function(){return e.onResize()},!1,a.Jf7)("mousemove",function(o){return e.moveImg(o)},!1,a.evT)("touchmove",function(o){return e.moveImg(o)},!1,a.evT)("mouseup",function(){return e.moveStop()},!1,a.evT)("touchend",function(){return e.moveStop()},!1,a.evT),2&t&&(a.Udp("text-align",e.alignImage),a.ekj("disabled",e.disabled))},inputs:{format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[a.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,e){1&t&&(a.TgZ(0,"div",null,0),a.YNc(2,K,2,5,"img",1),a._UZ(3,"div",2),a.YNc(4,D,3,15,"div",3),a.qZA()),2&t&&(a.Udp("background",e.imageVisible&&e.backgroundColor),a.xp6(2),a.Q6J("ngIf",e.safeImgDataUrl),a.xp6(1),a.Udp("width",e.maxSize.width,"px")("height",e.maxSize.height,"px")("margin-left","center"===e.alignImage?e.marginLeft:null),a.xp6(1),a.Q6J("ngIf",e.imageVisible))},directives:[F.O5],styles:['[_nghost-%COMP%]{display:flex;max-height:100%;max-width:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%], [_nghost-%COMP%] > div[_ngcontent-%COMP%]{position:relative;width:100%}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-height:100%;max-width:100%;transform-origin:center}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{left:0;outline:var(--cropper-overlay-color,#fff) solid 100vw;pointer-events:none;position:absolute;top:0;touch-action:none}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{background:transparent;color:#53535c;display:flex;outline:100vw solid hsla(0,0%,100%,.3);outline:var(--cropper-outline-color,hsla(0,0%,100%,.3)) solid 100vw;position:absolute;touch-action:none}@media (orientation:portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{border:1px dashed;bottom:0;color:inherit;content:"";left:0;opacity:.75;pointer-events:none;position:absolute;right:0;top:0;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border:1px solid hsla(0,0%,100%,.5);cursor:move;width:100%}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{display:inline-block;line-height:6px;opacity:.85;padding:8px;position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{background:#53535c;border:1px solid hsla(0,0%,100%,.5);box-sizing:content-box;display:inline-block;height:6px;width:6px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{cursor:nwse-resize;left:-12px;top:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{cursor:ns-resize;left:calc(50% - 12px);top:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{cursor:nesw-resize;right:-12px;top:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{cursor:ew-resize;right:-12px;top:calc(50% - 12px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;cursor:nwse-resize;right:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;cursor:ns-resize;left:calc(50% - 12px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;cursor:nesw-resize;left:-12px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{cursor:ew-resize;left:-12px;top:calc(50% - 12px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{cursor:ns-resize;height:22px;left:11px;top:-11px;width:calc(100% - 22px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{cursor:ew-resize;height:calc(100% - 22px);right:-11px;top:11px;width:22px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;cursor:ns-resize;height:22px;left:11px;width:calc(100% - 22px)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{cursor:ew-resize;height:calc(100% - 22px);left:-11px;top:11px;width:22px}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw hsla(0,0%,100%,.3);box-shadow:0 0 0 100vw var(--cropper-outline-color,hsla(0,0%,100%,.3))}@media (orientation:portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh hsla(0,0%,100%,.3);box-shadow:0 0 0 100vh var(--cropper-outline-color,hsla(0,0%,100%,.3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),s})(),O=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=a.oAB({type:s}),s.\u0275inj=a.cJS({imports:[[F.ez]]}),s})();var ht=_(6989),pt=_(5761);function dt(s,c){if(1&s){const t=a.EpF();a.TgZ(0,"image-cropper",11),a.NdJ("imageCropped",function(i){return a.CHM(t),a.oxw().imageCropped(i)}),a.qZA()}if(2&s){const t=a.oxw();a.Q6J("imageChangedEvent",t.img)("maintainAspectRatio",t.maintainAspectRatio)("aspectRatio",t.aspectRatio)("cropperMinWidth",128)}}let gt=(()=>{class s{constructor(t,e){this.customDialogService=t,this.nftService=e,this.imageChangedEvent="",this.croppedImage="",this.canvasRotation=0,this.rotation=0,this.scale=1,this.showCropper=!0}close(){this.customDialogService.closeImgCropDialogs(null)}crop(){this.customDialogService.closeImgCropDialogs(this.croppedImage)}fileChangeEvent(t){this.imageChangedEvent=t}imageCropped(t){this.croppedImage=t.base64}imageLoaded(){this.showCropper=!0}cropperReady(t){console.log("Cropper ready",t)}loadImageFailed(){console.log("Load failed")}}return s.\u0275fac=function(t){return new(t||s)(a.Y36(ht.W),a.Y36(pt._))},s.\u0275cmp=a.Xpm({type:s,selectors:[["app-image-cropper"]],inputs:{img:"img",aspectRatio:"aspectRatio",maintainAspectRatio:"maintainAspectRatio"},decls:15,vars:1,consts:[["alt","",3,"src"],[1,"px-4","image-cropper-model"],[1,"flex","justify-end"],[1,"btn-close",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"flex","items-center","justify-between"],[1,"inline-flex"],[1,"text-3xl","font-medium"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","cropperMinWidth","imageCropped",4,"ngIf"],[1,"primary-btn",3,"click"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","cropperMinWidth","imageCropped"]],template:function(t,e){1&t&&(a._UZ(0,"img",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"button",3),a.NdJ("click",function(){return e.close()}),a.O4$(),a.TgZ(4,"svg",4),a._UZ(5,"path",5),a.qZA(),a.qZA(),a.qZA(),a.kcU(),a.TgZ(6,"div",6),a.TgZ(7,"div",7),a.TgZ(8,"h1",8),a.TgZ(9,"span"),a._uU(10,"Ima"),a.qZA(),a._uU(11,"ge Crop"),a.qZA(),a.qZA(),a.qZA(),a.YNc(12,dt,1,4,"image-cropper",9),a.TgZ(13,"button",10),a.NdJ("click",function(){return e.crop()}),a._uU(14," Crop "),a.qZA(),a.qZA()),2&t&&(a.xp6(12),a.Q6J("ngIf",e.aspectRatio))},directives:[F.O5,M],styles:[".image-cropper-overlay{height:auto;min-height:421px;max-width:581px!important}.image-cropper-model[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:0;padding-right:0}@media (min-width: 640px){.image-cropper-model[_ngcontent-%COMP%]{padding-left:5rem;padding-right:5rem}}.image-cropper-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{position:absolute;top:0px;right:0px;margin:.875rem;border-radius:9999px;--tw-bg-opacity: 1;background-color:rgba(255,255,255,var(--tw-bg-opacity));opacity:.5}.image-cropper-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{opacity:.7}.image-cropper-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:1px}.image-cropper-model[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#132356}.image-cropper-model[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:3rem;margin-bottom:3rem;text-transform:capitalize}.image-cropper-model[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-bottom:4px;border-bottom:2px solid #75F16D}.image-cropper-model[_ngcontent-%COMP%]   .primary-btn[_ngcontent-%COMP%]{height:3rem;width:11rem;align-self:center}@media (min-width: 640px){.image-cropper-model[_ngcontent-%COMP%]   .primary-btn[_ngcontent-%COMP%]{margin-top:3.5rem;margin-bottom:3.5rem}}"]}),s})(),lt=(()=>{class s{static getImageCropperComponent(){return gt}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=a.oAB({type:s}),s.\u0275inj=a.cJS({imports:[[F.ez,O]]}),s})()}}]);